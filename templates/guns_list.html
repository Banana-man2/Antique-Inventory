<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Antique-Inventory</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #4a4a4a; color: white; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        a { color: #337ab7; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .btn { display: inline-block; padding: 8px 16px; background-color: #337ab7; color: white; border-radius: 4px; margin-bottom: 16px; }
        .btn:hover { background-color: #286090; color: white; }
    </style>
</head>
<body>
    <h1>Antique-Inventory</h1>
    <a class="btn" href="/guns/new">Add New Gun</a>
    <form method="GET" action="/guns" style="margin-bottom: 16px; display: flex; gap: 8px; align-items: center;">
        <input type="text" name="q" value="{{.query}}"
               placeholder="Search by name, serial, description..."
               style="padding: 8px; width: 320px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
        <button type="submit" class="btn" style="margin-bottom: 0;">Search</button>
        {{if .query}}<a class="btn" href="/guns" style="margin-bottom: 0; background-color: #888;">Clear</a>{{end}}
    </form>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Serial Number</th>
                <th>Year</th>
                <th>Condition</th>
                <th>Value ($)</th>
                <th>Description</th>
                <th>Image</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{range .guns}}
            <tr>
                <td>{{.ID}}</td>
                <td>{{.GunName}}</td>
                <td>{{.SerialNumber}}</td>
                <td>{{if .Year}}{{.Year}}{{else}}-{{end}}</td>
                <td>{{if .Condition}}{{.Condition}}{{else}}-{{end}}</td>
                <td>{{if .Value}}{{.Value}}{{else}}-{{end}}</td>
                <td>{{.Description}}</td>
                <td>{{if .Image}}<img src="/guns/{{.ID}}/image" style="max-height: 60px;">{{end}}</td>
                <td>
                    <a href="/guns/{{.ID}}">View</a> |
                    <a href="/guns/{{.ID}}/edit">Edit</a> |
                    <form method="POST" action="/guns/{{.ID}}/delete" style="display:inline;"
                          onsubmit="return confirm('Are you sure you want to delete this item?')">
                        <button type="submit" style="background:none;border:none;color:#d9534f;cursor:pointer;padding:0;font-size:inherit;">Delete</button>
                    </form>
                </td>
            </tr>
            {{else}}
            <tr>
                <td colspan="9">No guns in inventory.</td>
            </tr>
            {{end}}
        </tbody>
    </table>
    <p style="margin-top: 12px; font-weight: bold;">Total Guns: {{.count}}</p>
    <p style="font-weight: bold;">Total Value: ${{printf "%.2f" .totalValue}}</p>
</body>
</html>
